<!DOCTYPE html> 
<html lang="en"> 
<head> 
  <meta charset="UTF-8"> 
  <title>Reset Password</title> 
  <style> 
    body { 
      font-family: Arial, sans-serif; 
      display: flex; 
      justify-content: center; 
      align-items: center; 
      height: 100vh; 
      background-color: #f4f6f9; 
    } 
    .card { 
      background: #fff; 
      padding: 30px; 
      border-radius: 8px; 
      box-shadow: 0px 4px 6px rgba(0,0,0,0.1); 
      width: 350px; 
      text-align: center; 
    } 
    h2 { 
      margin-bottom: 20px; 
    } 
    input { 
      width: 100%; 
      padding: 10px; 
      margin: 10px 0; 
      border: 1px solid #ccc; 
      border-radius: 5px; 
    } 
    button { 
      background-color: #4CAF50; 
      color: white; 
      padding: 10px; 
      width: 100%; 
      border: none; 
      border-radius: 5px; 
      cursor: pointer; 
      font-size: 16px; 
      margin-top: 10px; 
    } 
    button:hover { 
      background-color: #45a049; 
    } 
    .message { 
      margin-top: 15px; 
      font-weight: bold; 
    } 
    .error { 
      color: red; 
    } 
    .success { 
      color: green; 
    } 
  </style> 
</head> 
<body> 
  <div class="card"> 
    <h2>Reset Password</h2> 
    <form id="reset-form"> 
      <input type="password" id="password" placeholder="Enter new password" required /> 
      <input type="password" id="confirmPassword" placeholder="Confirm new password" required /> 
      <button type="submit">Reset Password</button> 
      <p id="msg" class="message"></p> 
    </form> 
  </div> 

  <script> 
    document.getElementById("reset-form").addEventListener("submit", async function(e) { 
      e.preventDefault(); 
      const password = document.getElementById("password").value; 
      const confirmPassword = document.getElementById("confirmPassword").value; 
      const msg = document.getElementById("msg"); 
      if (password !== confirmPassword) { 
        msg.textContent = "Passwords do not match!"; 
        msg.className = "message error"; 
        return; 
      } 
      const resetId = window.location.pathname.split("/").pop(); // get id from URL 
      try { 
        const res = await fetch(`/password/resetpassword/${resetId}`, { 
          method: "POST", 
          headers: { "Content-Type": "application/json" }, 
          body: JSON.stringify({ password }) 
        }); 
        const data = await res.json(); 
        if (data.success) { 
          msg.textContent = data.message; 
          msg.className = "message success"; 
          setTimeout(() => { 
            window.location.href = "http://127.0.0.1:5500/expense-tracker/public/html/login.html"; 
          }, 2000); 
        } else { 
          msg.textContent = data.message || "Something went wrong!"; 
          msg.className = "message error"; 
        } 
      } catch (err) { 
        console.error("Error:", err); 
        msg.textContent = "Server error. Please try again."; 
        msg.className = "message error"; 
      } 
    }); 
  </script> 
</body> 
</html>
